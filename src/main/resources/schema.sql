/*CREATE TYPE USERARRAY AS INTEGER ARRAY[100];

*/
DROP TABLE IF EXISTS KANBAN;
DROP TABLE IF EXISTS USERS;
DROP TABLE IF EXISTS NOTE;
DROP TABLE IF EXISTS PERMISSION;
DROP TABLE IF EXISTS ATTACHMENT;

CREATE TABLE USERS (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    permission BIGINT DEFAULT NULL,
    kanban_id BIGINT DEFAULT NULL,
    permission_id BIGINT DEFAULT NULL
);

CREATE TABLE KANBAN (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    title VARCHAR(250) NOT NULL,
    user_id BIGINT DEFAULT NULL
);

CREATE TABLE NOTE (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    content VARCHAR(1000) NOT NULL,
    attachment_id BIGINT DEFAULT NULL
);


CREATE TABLE PERMISSION (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    permission BIGINT NOT NULL,
    user_id BIGINT DEFAULT NULL,
    kanban_id BIGINT DEFAULT NULL
);


CREATE TABLE ATTACHMENT (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    note_id BIGINT DEFAULT NULL
);

ALTER TABLE USERS ADD FOREIGN KEY (kanban_id) REFERENCES KANBAN (id);

ALTER TABLE KANBAN ADD FOREIGN KEY (user_id) REFERENCES USERS (id);

ALTER TABLE USERS ADD FOREIGN KEY (permission_id) REFERENCES PERMISSION (id);

ALTER TABLE NOTE ADD FOREIGN KEY (attachment_id) REFERENCES ATTACHMENT (id);

ALTER TABLE PERMISSION ADD FOREIGN KEY (user_id) REFERENCES USERS (id);

ALTER TABLE PERMISSION ADD FOREIGN KEY (kanban_id) REFERENCES KANBAN (id);